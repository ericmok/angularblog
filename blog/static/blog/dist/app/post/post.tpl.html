<div ng-controller="PostCtrl" class="row">

	<div ng-repeat="panel in sidebars" 
			ng-class="{'col-xs-7': $index === currentPointer, 'current-panel': $index === currentPointer, 'col-xs-5': $index == currentPointer + 1, 'zoom-small': loading && $index === currentPointer + 1}" 
			ng-hide="($index < currentPointer) || ($index > currentPointer + 1)"
			class="sidebar-panel" >
		
        <!-- Main Post -->
		<div ng-if="$index === currentPointer">
			<article class="post" ng-repeat="comment in panel.results">
				<header>
					<hgroup>
						<div>
							<h1>{{comment.title}}</h1> 
						</div>
						<h4 class="author">{{comment.author}} on [{{comment.parent_content_type}} / {{comment.parent_id}}]</h4>
					</hgroup>
					<button style="vertical-align: middle" class="btn btn-info">Revise Post</button>
				</header>

				<p ng-repeat="para in comment.content.paragraphs">
					<span ng-repeat="sen in para.sentences" class="sentence" ng-class="{'sentence-selected': sen.id == currentlySelectedSentenceId}" ng-mouseover="updateSidebar(sen.id, $parent.$parent.$index)" ng-mouseout="cancelTimers()">
						{{sen.text}}
						<span class="badge" ng-if="sen.number_replies > 0">{{sen.number_replies}}</span>
					</span>
				</p>

			</article>
            
            <div class="post-reply">
                <login-form>
                    Test
                </login-form>
                <form class="form">
                    <input class="form-control" type="text" placeholder="Title" />
                    <textarea class="form-control" ></textarea>
                </form>
                <button class="btn btn-primary">Reply to Post</button>
            </div>
            
			<article class="reply" ng-repeat="comment in mainComments.results">
				<header>
					<hgroup>
						<div>
							<h1 style="margin-right: 1.4em; vertical-align: middle; display: inline;">{{comment.title}}</h1> 
                            <a style="vertical-align: imgddle" class="btn btn-info" href="#/post/{{comment.id}}">Go to Post to Reply &gt;&gt;</a>
						</div>
						<h4 class="author">{{comment.author}} on [{{comment.parent_content_type}} / {{comment.parent_id}}]</h4>
					</hgroup>
				</header>

				<p ng-repeat="para in comment.content.paragraphs">
					<span ng-repeat="sen in para.sentences"  class="sentence">
						{{sen.text}}
					</span>
				</p>

			</article>
			<article class="reply" ng-if="mainComments.results.length < 1">
				There are no comments for this Post. Perhaps there are comments on the sentences instead?
			</article>
		</div>
		
		<!-- If this panel's index is on the right side... -->
		<div ng-if="$index == currentPointer + 1" style="position: relative;">
			
			<!-- Loading message -->
			<div ng-if="loading" style="position: absolute; width: 100%; height: 100%; background: #FFF; opacity: 0.5; text-align: center;">
				<h2 style="font-family: 'Open Sans'">Loading...</h2>
			</div>

			<!-- Quote -->
			<header class="sidebar-quote" ng-if="currentlySelectedSentenceObj !== null">
				<section>
				
					<blockquote>
						{{currentlySelectedSentenceObj.text}}
					</blockquote>

				</section>
			</header>

            <div ng-controller="SentenceCommentCtrl" class="sentence-comment-control">
                <div style="text-align: center;"ng-show="!isMakingComment">
                    <button class="btn btn-primary" ng-click="makeComment(currentlySelectedSentenceObj)">Leave a Comment</button>
                </div>
                <div ng-if="isMakingComment">
                    <div class="login-prompt">
                        <div ng-if="!isLoggedIn()">
                            Login to Leave a Comment
                        </div>
                        <login-form></login-form>
                    </div>
                    <div ng-if="isLoggedIn()" class="make-comment">
                        <div class="well well-sm" style="text-align: left">
                            <blockquote>{{currentlySelectedSentenceObj.text}}</blockquote>
                        </div>
                        <form class="form">
                            <input type="text" class="form-control title" ng-model="comment.title"  placeholder="Title" />
                            <textarea class="form-control" placeholder="Enter your post here..." ng-model="comment.content"></textarea>
                            <input type="submit" class="btn btn-primary" value="Submit Comment" ng-click="submitComment()" />
                        </form>
                    </div>
                </div>
                <div>
                    {{error}}
                </div>
                <div ng-if="commentWasMade">
					<h2>Your comment was made!</h2>
                </div>
            </div>

			<!-- Reply -->
			<article class="reply" ng-repeat="comment in panel.results">
				<header>
					<hgroup>
						<div>
							<h2 style="margin-right: 1.4em; vertical-align: middle; display: inline;">{{comment.title}}</h2> 
							<a style="vertical-align: imgddle" class="btn btn-info" href="#/post/{{comment.id}}">Go to Post to Reply &gt;&gt;</a>
						</div>
						<h4 class="author">{{comment.author}} on [{{comment.parent_content_type}} / {{comment.parent_id}}]</h4>
					</hgroup>
					<div class="well well-sm">
						<blockquote>
							{{currentlySelectedSentenceObj.text}}
						</blockquote>
					</div>
				</header>

				<p ng-repeat="para in comment.content.paragraphs">
					<span ng-repeat="sen in para.sentences"  class="sentence">
						{{sen.text}}
					</span>
				</p>

			</article>

			<!-- No posts message -->
			<article class="reply zero-posts" ng-if="panel.results.length < 1">
				<div>
					There are no posts for this sentence.
				</div>
			</article>
		</div>

	</div>
</div>